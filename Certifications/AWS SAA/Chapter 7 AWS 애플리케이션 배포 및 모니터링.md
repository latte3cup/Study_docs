#### AWS Lambda
- 각종 이벤트에 반응해 백엔드 코드를 실행하는 컴퓨팅 리소스를 제공하는 `서버리스` 서비스
- 현재 1ms 단위 요금 부과 + 요청 백만건 부터 부과

##### 서버리스의 조건
1. 인프라 관리 필요성 일절 없음
2. 확장성 : 스케일 업 / 다운 지원 및 가능 해야함. (일반적으로 자동적으로)
3. 내재된 중복 구현성 : 항상 고가용성 유지할 수 있어야 함.
4. 사용량에 따른 과금 : 오직 사용만에만 부과되며 유휴된 어떠한 자원에서는 과금 받지 않음

###### AWS 주요 서버리스 서비스
	- Amazon S3
	- Amazon DynamoDB 
	- Amazon Api Gateway
	- AWS Lambda
	- Amazon SNS and SQS
	- Amazon CloudWatch Events
	- Amazon Kinesis

##### Lambda의 개요
- 가장 단순한 아킻텍처를 보여줌. 이벤트 소스 -> 이벤트 -> 람다 실행 -> 서비스 작동(무엇이든)
- 병렬적으로도 실행가능. 함수 갯수 제한 없음
- Stateless 속성을 가지므로 운영 단순성, 격리된 보안성, 무한확장성, 비용최적화의 장점
- 보통의 프로그래밍 코드를 작성하여 기능 사용 

##### 람다 사용 단계
1. 코드 준비 : 원하는 언어로 함수 코드 작성  
2. 함수에 롤을 추가하거나 함수에 필요한 롤을 생성
3. 함수를 생성한 뒤 Lambda 함수를 호출하기 위한 트리거 추가
4. 실행 및 테스트
5. 모니터링 및 운영

###### Lambda가 지원하는 네이티브 언어
	- java
	- Node.js
	- Python
	- C#
	- Go
	- Powershell
	- Ruby
###### 리소스 용량 제한
| 항목                           | 제한 값                                                   |
| ---------------------------- | ------------------------------------------------------ |
| **메모리 (Memory)**             | 최소 **128 MB** ~ 최대 **10 240 MB (10GB)**, 1 MB 단위 조정 가능 |
| **CPU (vCPU)**               | 메모리 크기에 비례해 자동 할당, 최대 약 **6 vCPU**                     |
| **실행 시간 (Timeout)**          | 기본값 **3초**, 최대 **900초 (15분)**                          |
| **임시 스토리지 (/tmp)**           | 기본 **512MB**, 확장 시 최대 **10GB**                         |
| **환경 변수 (Environment Vars)** | 최대 **4KB**                                             |
| **배포 패키지 (코드 + 라이브러리)**      | ZIP 업로드: **50MB** / S3 업로드: **250MB**                  |
| **Lambda 레이어 (Layer)**       | 함수당 최대 **5개**, 각 레이어는 **50MB** 한도                      |
| **동시 실행 (Concurrency)**      | 기본 **1,000**, 요청 시 증가 가능                               |
| **코드 저장소 총량**                | 리전(Region)당 최대 **75GB**                                |
| **파일 디스크립터/스레드**             | 각 **1,024개** 제한                                        |
| **ENI (VPC 연결 시)**           | 함수당 최대 **500개**                                        |

###### 람다에 적합한 패턴
1. 실시간 파일 데이터 처리
2. 실시간 스트렘 데이터 처리
3. ETL 작업
4. Cron 대체 : 크론식으로 함수 실행 가능
5. Aws Events 처리

---

#### Amazon API Gateway - 서버리스
- WS에서 완전관리형(Managed Service)으로 제공하는 API 게이트웨이. 서버를 직접 띄우지 않고, AWS가 인프라를 운영.
- 백엔드 HTTP  엔드포인트, AWS 람다 함수 또는 기타 AWS 서비스에 연결하기 위한 레스트풀 API 생성, 배포 관리
- 프론트엔드 HTTP 엔드포인트를 통해 외부로 노출된 API 호출 (즉 외부 공개 API)
- API 호출 및 전송된 데이터의 양에 따라 과금 
- 지원하는 API 유형
	1. REST API : 사용량 계획, API 키, API 배포 및 수익화 등 다양한 관리 기능 제공
	2. WebSocket API : 클라이언트와 지속형 연결 유지 기능 제공
	3. Http API : 람다함수 또는 HTTP 백엔드의 프록시 역할을 하는 API 구현에 최적화.
- 장점
	1. 확장성과 관리 효율
		- **완전관리형 서비스**라 서버 인프라 구성 및 확장, 운영체제·보안 패치 관리가 불필요
		- **대규모 동시 호출** 처리: 수백만 건의 API 호출도 효과적으로 처리 가능 
	2. 다양한 인증·보안 기능
		- **IAM 역할(Auth)**, **Lambda Authorizer**, **Amazon Cognito** 등 다양한 인증 방식 지원 
		- **AWS WAF(Web Application Firewall)**로 API에 대한 방화벽 규칙 적용 가능 
	3. 모니터링 및 배포 지원
		- **CloudWatch**를 통한 호출 수, 지연 시간, 오류율 등 다양한 메트릭 모니터링 가능
		- **캔더리(추단계) 배포**를 통해 안전하게 새로운 버전 배포 가능
	4. 비용 및 성능 최적화 (HTTP APIs)
		- HTTP APIs는 **REST APIs보다 비용이 낮고 지연도 짧음**
		- **자동 배포(auto deploy)**, **CORS (Cross-Origin Resource Sharing)** 지원 자동화
	5. 백엔드 통합 유연성
		- AWS Lambda, EC2, ECS, 외부 HTTP 엔드포인트, VPC 내부의 ALB/NLB, Cloud Map 등 다양한 백엔드로 통합 가능
		- 특히 HTTP APIs는 private integration (VPC 환경의 로드밸런서 포함)도 지원
	6. 라이플 사이클 관리
		- 동일한 API의 다양한 버전 관리 가능
	7. Open API 명세서 (Swagger)(2.0) 및 3.0 지원
	8. iOS, Android, JavaScript용  SDK 지원으로 API-Gateway 관리 및 제어가능

--- 
#### Amazon Kinesis
- 대규모 데이터 스트림(초당 수백 MB~GB)을 실시간으로 수집, 저장, 처리할 수 있는 관리형 서비스.
- 로그, IoT 센서 데이터, 클릭스트림, 애플리케이션 이벤트, 비디오 스트림 등 **끊임없이 발생하는 데이터**를 지연 없이 처리.
- 서버 관리 불필요(완전 관리형), 확장성 자동 제공, 다양한 AWS 서비스와 연계.
- 대부분 키네시스가 람다를 트리거함.

##### 실시간 애플리케이션 시나리오
- 배치 분서에서 스트리밍 분석으로 진화 : 데이터 유입하자마자 처리하므로 분석 결과의 최신성 및 신뢰성 상승
- 실시간 애플리케이션 개발 : 거의 중단없는 콘텐츠 제공할수 있도록 도움

##### **주요 서비스 구성**
Amazon Kinesis는 크게 네 가지 서비스로 나뉩니다.

1. **Kinesis Data Streams (KDS)**
    - 초당 대규모 데이터 스트림을 **실시간 수집·저장**. (샤드로서 **스트림에 저장**)
    - 생산자(Producer)가 데이터를 스트림에 넣으면, 소비자(Consumer) 앱이나 Lambda가 데이터를 읽어서 처리.
    - 데이터를 샤드(shard) 단위로 분산 저장해 확장성 확보.
    - 다중 AZ에 복제 저장, 보존기간 24h~356d, **at-least-once(최소 1회 전달 보장)** 모델
    - 병렬 처리 - 여러 컨슈머가 각자 독립적으로 데이터를 읽을 수 있음
    - 스트림의 성능을 동적 스케일링 가능
    - **샤드 관리 필요**
    - **실시간 버퍼**의 역할
    - 예: 클릭 로그, IoT 센서 값, 게임 이벤트 수집.

2. **Kinesis Data Firehose**
    - 스트림 데이터를 자동으로 **다른 저장소(스토리지)로 적재(Load)**.
    - 대상: Amazon S3, Redshift, OpenSearch, Splunk 등.
    - 서버나 코드 작성 불필요, 거의 실시간(몇 초 단위)으로 전송. --> 근실시간 수준
    - 간단한 데이터 변환 및 사용편리성
    - 지속적 관리 필요 없음. 다른 스토리지에 저장되기 때문
    - **저장·적재 파이프라인**의 역할
    - 예: 실시간 로그를 S3에 쌓고 Athena/Redshift로 분석.

3. **Kinesis Data Analytics**
    - 스트림 데이터를 **SQL, Apache Flink**로 실시간 분석.
    - 스트림에서 들어오는 이벤트를 집계·변환·필터링.
    - 샤드의 묶음(하나의 스트림)을 원천으로 SQL, FLink 가 데이터 처리
    - 스트리밍 데이터를 직접 수집·저장하는 엔진이 아니라, **분석/처리**하는 엔진의 역할
    - 예: 실시간 대시보드, . 시계열 분석
    - 이상 탐지(Anomaly Detection) -> 대시보드 및 실시간 경고&알림

4. **Kinesis Video Streams**
    - 실시간으로 들어오는 영상·오디오 스트림을 **AWS가 자동으로 캡처하고 암호화·저장**
    - 멀티 미디어 스트림을 처리
    - IoT 카메라, CCTV, 드론 영상 등에서 발생하는 영상 데이터를 클라우드로 전송.
    - ML(예: Rekognition)과 결합해 객체 탐지, 얼굴 인식 가능. 수백만개의 디바이스로부터 비디오 스트리밍. 실시간 영상 송출 및 라이브 비디오 재생 등

---
#### AWS CloudFront
- 글로벌 CDN(Content Download Network) 서비스
- 저지연성 고속전송 속성을 지닌 콘텐츠 배포 기능을 제공. 
- 엣지로케이션에 네트워크망을 구축하고 지역별 엣지 캐시를 통해  UX 수준 높임
- 사용자가 실제로 요청 및 전송한 데이터에 대한 비용 부담.
- 리전과 CloudFront 엣지 로케잇견 간의 전송 비용은 부담하지 않음
###### 활용처
- 정적 콘텐츠 캐싱 : 사진/영상/스타일시트/Js등 정적 콘텐츠 전송 속도 상승
- 동적 콘텐츠 : EC2 / 앱 등 통합 가능
- DDoS 공격 대응 및 강화된 보안성 : CloudFront는 기본 TLS/Signed Url에 , 보안 레이어 3, 4 ,7에  보호가능한 AWS Shield , AWS WAF 와 통합해 보안 기능 제공
- API 호출 가속화 : API - Gateway 와 통합해 API 호출 가속화 . vmfhrtl aptjem wldnjs
- 소프트웨어 배포
- 비디오 스트리밍

##### CloudFront 핵심 개념
- 엣지 로케이션(Edge Location) : 글로벌 데이터 센터 네트워크. 세계 주요 대도시에 위치. 리전과 위치가 다를 수 있음
- 지역별 엣지 캐시 : 오리진 웹 서버와 엣지 로케이션 사이에 위치해 사용자에게 직접 콘텐츠 전송
  자주 사용하느냐에 따라 캐싱 유지 기간이 달라짐
- 배포 : 원본 파일의 위치를 나타내는 CLoudFront 경로로, CloudFront.net 도메인 네임으로 표시되며, 글로벌 엣지로케이션에서 사용자의 객체 참조 시 사용할 수 있음. 
  => CDN 동작을 위한 설정 패키지
- 오리진 : CloudFront가 가져올 원본 서버 (EC2, S3, ALB, API-gateway, 외부 Http 서버 등)
- 제어 동작(Behaviors) - 캐시 동작(Cache Behavior)” : **라이언트 요청이 들어왔을 때 CloudFront가 어떤 오리진을 선택하고, 어떻게 캐싱·보안·라우팅을 적용할지**를 정의하는 설정
  CDN과 관련된 정책의 허용, 요청 타입에 따른 반응 변경, 객체의 캐싱 기능 조절 등 CloudFront의 세부적인 제어 동작을 의미

#### 주요 제어 동작
1. 경로 패턴 매칭(Path Pattern Matching) 
	- URL 경로에 따라 캐시 제어 동작 설정
	- 경로 패턴에 따라 Http/s 프로토콜 설정, 헤더 또는 캐싱 옵션, 쿠키 및 쿼리 문자열, 접근제한 등의 방식으로 특정 오리진으로 요청을 전송함.
2. 헤더
	- 헤더 값을 통해 요청 헤더를 오리진 캐시로 포워딩하여 동작을 적용 시킬 수 있음
3.  쿼리 문자열 및 쿠키
	- 쿼리 스트링과 쿠키를 통해 다른 캐싱 콘텐츠 제공
4.  서명 URL 및 서명 쿠키
	- 만료일 및 만료시간, 개별 리소스 제한, 특정 IP 범위 접근 제한 등 조건부 접근 (여기에 지역 제한 가능)에 대한 내용을 URL이나 쿠키에 담아 클라이언트는 접속하고 CloudFront는 해당 정보를 검증하여 제어
	- 보통 서명 URL 및 서명 쿠키 사용할떄 콘텐츠즐 즐기는 URL과 콘텐츠를 접근하는 URL을 분리하여 운영
5. 프로토콜 정책 : HTTP/ HTTPS 구별하게함.
6. 유지시간 : TTL을 통해 엣지 캐시가 유지되는 시간 설정.
7. gzip 압축 : 배포 설정시 자동 gzip 압축을 적용하여 대역폭 절감, 속도 향상, 오리진 부하 감소 가능
#### 배포 방식
##### 1. 배포 유형 (Distribution Type)
현재 CloudFront에서는 사실상 **웹 배포(Web Distribution)** 방식만 사용합니다.
- **웹 배포 (Web Distribution)**
    - 정적 파일 (HTML, CSS, JS, 이미지 등)
    - 동적 콘텐츠 (API 응답, GraphQL, JSON 등)
    - 미디어 스트리밍 (HLS, DASH)
    - 가장 일반적인 형태
- **RTMP 배포 (Deprecated)**
    - 과거 플래시 기반 스트리밍용 (RTMP 프로토콜)
    - 현재는 지원 중단 → 웹 배포로 HLS/DASH를 사용
 따라서 현재는 **웹 배포 하나로 모든 사용 사례(정적·동적·스트리밍)를 처리**
##### 2. 콘텐츠 제공 방식
###### 🔹 Pull 방식 (일반적)
- 사용자가 요청하면 CloudFront 엣지가 **오리진에서 가져와 캐시에 저장** 후 전달.
- 다음 요청부터는 엣지 캐시에서 바로 응답.
- 예:
    - 오리진: S3, ALB, EC2, API Gateway
    - CloudFront가 필요할 때만 가져와서 캐시 → **Lazy Loading**
###### 🔹 Push 방식 (사전 캐싱, Pre-populate)
- CloudFront는 기본적으로 Pull 방식이지만, 관리자가 **Invalidation(무효화)**, **Lambda@Edge**, 또는 **사전 Warm-up 요청**을 통해 캐시를 미리 채울 수도 있음.
- 사용자가 처음 접근하기 전에 캐시에 담아두는 전략.
- 대규모 이벤트/신제품 발표처럼 초기 트래픽이 폭발할 때 활용.

###### 오류처리 기능
- 콘텐츠 요청에 대해 오리진 서버가 400 , 500번대의 상태 코드 반환시 클라우드 프론트에서 커스텀 오류페이지 반환 가능. TTL을 정의해 캐시 오류도 유지 시킬 수 있음.

---

