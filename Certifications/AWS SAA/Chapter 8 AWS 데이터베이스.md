### RDBMS
데이터를 **테이블(표)** 구조로 저장하고, **관계(Relationship)** 를 통해 서로 연결하여 관리하는 데이터베이스 시스템

###### 특징
- **테이블 기반 구조**
    - 행(Row, 레코드)과 열(Column, 속성)으로 데이터 저장.
- **관계(Relation)**
    - 여러 테이블 간을 기본 키(Primary Key), 외래 키(Foreign Key)로 연결.
- **SQL(Structured Query Language)** 지원
    - 데이터 정의(DDL), 조작(DML), 제어(DCL)를 위한 표준 언어.
- **ACID 특성**
    - 원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability) 보장 → 안정적인 트랜잭션 처리.

---
#### RDS 개요
##### DB 호스팅 시나리오
1. 온프레미스 데이터 센터에서 DB 호스팅 --> 서버 비용 및 관리 다 해야함
2. AWS EC2에 호스팅 --> 인프라 관련 비용만 없어지지만 RDBMS 관리에 대한 업무 수행
3. AWS RDS --> 인프라 관리 불필요, 즉각적 프로비저닝, 확장성, 비용효율성, 호환성, 고가용성, 보안유지

##### RDS 대신 EC2를 택하는 경우
-  DB 인스턴스에 대한 완전한 통제권을 원하는 경우
-  운영체제에 대한 통제권을 원하는 경우
-  백업, 복제 클러스터링에 대한 통제권을 원하는 경우
-  기업의 RDBMS 엔진의 주요 기능과 RDS와 맞지 않은 경우
- 기업이 요구하는 용량 성능이 RDS가 못미치는 경우

##### RDS의 고가용성 구현 (HA)
1. 싱글 AZ
2. 멀티 AZ : 스토리지가 복제되어 가용성 확보. DNS 문제 시 어짜피 엔드포인트 하나에서 분산

##### RDS의 확장성 구현
-  스케일업/다운 : 인스턴스 클래스 타입을 변경
-  스케일 아웃 & 인 : 
	- 읽기 복제본(Read Replica) -> 읽기 요청 분산으로 읽기 성능 향상
	  읽기 복제본은 복제 자체는 동기적이지만 동기적으로 이루어지지 않음
	  따라서 마스터 장애시 읽기 사본이 마스터로 되는 과정에서 데이터 손실 가능 -> 스탠바이 인스턴스를 둬야함
	- 특히 Aurora는 Auto Scaling 지원하나 읽기 복제본과 다를게 없음

#### RDS의 보안성 구현
1. 네트워크 수준 보안
	-  RDS는 VPC 위에서 배치 및 동작 되므로  VPC 네트워크 설정으로 접근 통제
	- 보안그룹, 네트워크 ACL 을 통해 방화벽 적용
2. 접근 제어
	- IAM 인증을  통해 DB 로그인 -> 패스워드 관리 부담 감소
	- Secret Manager/ Systems Manager Parameter Store 등을 통해 주기적으로 암호 회전 등
3. 데이터 보호 (암호화)
	- DB 인스턴스 스토리지, 백업, 읽기 사본, 스냅샷 등 모든 항복을 암호화 가능
	- RDS 암호화 구조는 이중 키 계층 (2-tier)
	- KMS로 RDS 데이터 키를 암호화함. 이유는 KMS는 비대칭키, RDS 데이터 키는 대칭키로 함으로써 성능 및 안전한 인증을 적용.
	- 또한 KMS 마스터키만 교체함으로써 데이터 전체를 다시 암복호화 할필요 없이 데이터키만 함으로써 재암호화됨
###### 특징
1. RDS 생성시에만 암호화 적용 가능. 변경을 원하면 마이그레이션 해야함
2. 한번 암호화를 한 인스턴스는 암호화 해제 불가.
3. 마스터 베이스와 읽기 사본은 반드시 암호화해야함 (동일한 키로 암호화 됨)
4. KMS가 리전별 서비스 이므로 RDS를 다른 리전으로 복사 불가


##### 백업, 복구, 스냅샷
#####  백업 (Backup)
- **자동 백업(Automated Backup)**
    - RDS가 제공하는 기본 기능.
    - 특정 보관 기간(최대 35일)을 설정하면 → 그 기간 동안 **지속적으로 트랜잭션 로그 + 하루 1회 전체 스냅샷**을 관리.
    - 이 조합으로 **Point-in-Time Recovery (PITR)** 가능.
        - 예: “어제 오후 3시 25분 시점으로 DB 복구해줘” 가능.
    - 백업은 S3에 안전하게 저장됨 (사용자 직접 접근은 불가).
- **특징**
    - 인스턴스 삭제 시 자동 백업도 함께 제거됨.
    - 보관 기간을 0으로 설정하면 자동 백업 꺼짐.
##### 스냅샷 (Snapshot)
- **수동 스냅샷(Manual Snapshot)**
    - 사용자가 필요할 때 직접 생성하는 백업.
    - 보존 기한 제한 없음 → 사용자가 지우기 전까지 계속 유지.
    - 다른 AWS 계정이나 리전에 공유/복사 가능 (단, 암호화된 경우 KMS 키 권한 필요).
- **특징**
    - 인스턴스 삭제 후에도 스냅샷은 남음.
    - 스냅샷을 기반으로 새 DB 인스턴스 생성 가능.
    - 암호화 여부는 원본을 그대로 따름 (암호화된 스냅샷 → 암호화된 복원).
##### 복구 (Restore)
- **자동 백업에서 복구**
    - 설정된 보관 기간 내에서 **임의의 시점(PITR)**으로 복구 가능.
    - 새로운 DB 인스턴스가 생성되며, 원본과 별도로 동작.
- **스냅샷에서 복구**
    - 수동/자동 스냅샷을 기반으로 DB 인스턴스를 새로 생성.
    - 복원 후 독립된 인스턴스가 되므로, 원본 DB와는 분리되어 있음.

##### 모니터링
###### 기본 모니터링 (기본 지표, CloudWatch)
- RDS는 기본적으로 **CloudWatch 지표(Metrics)** 를 1분 단위로 제공합니다.
- 대표 지표:
		- **CPUUtilization** (CPU 사용률)
		- **FreeableMemory** (사용 가능 메모리)
		- **FreeStorageSpace** (남은 스토리지 공간)
		- **ReadIOPS / WriteIOPS** (디스크 I/O)
		- **DatabaseConnections** (DB 연결 수)
		- **ReplicaLag** (읽기 복제본 지연 시간)
- 장점: 기본 제공, 추가 비용 없음.
- 한계: DB 엔진 내부 상태(쿼리, 버퍼 캐시 등)는 보이지 않음.
###### 향상된 모니터링 (Enhanced Monitoring)
- OS 레벨 지표를 최대 1초 간격으로 수집.
- 약 총 50개의 지표
- CloudWatch가 아니라 **CloudWatch Logs**에 저장됨.
- 예: CPU 커널/유저 모드 분리, 스왑 사용량, 디스크 IOPS 세부 값, 네트워크 패킷 단위.
- → 인스턴스 내부 리눅스 OS 상태까지 가시성 확보.
###### 퍼포먼스 인사이트 (Performance Insights)
- DB 엔진 내부의 **쿼리 성능 및 부하 분석 도구**.
- AAS(Average Active Sessions, 평균 활성 세션) 기준으로 병목 지점을 보여줌.
- 기능:
    - 어떤 SQL이 CPU/I/O 부하를 많이 차지하는지 식별.
    - Wait event 분석 (락 대기, I/O 대기 등).
    - 시각화된 대시보드 제공 (병목 원인 파악에 유용).
- 지난 15분간의 데이터를 보여주며 (60분까지 가능) , 35일간 보관
##### RDS 이벤트 노티피케이션
- SNS와 연동하여 알림 전송

----
#### Amazon Aurora
- **클라우드 네이티브 관계형 데이터베이스(RDBMS)** 로, **MySQL·PostgreSQL과 호환**되면서도 **고성능·고가용성·자동 확장** 기능을 제공
##### 핵심 특징
- **호환성**: MySQL, PostgreSQL 엔진과 호환 → 기존 앱/도구 그대로 사용 가능.
- **성능**: 같은 하드웨어에서 표준 MySQL 대비 최대 5배, PostgreSQL 대비 최대 3배 성능.
- **스토리지 아키텍처**:
    - 데이터를 **6중 복제(3개 AZ에 2개씩)** 저장.
    - 스토리지는 자동으로 확장(최대 128TB).
- **고가용성**
	- 장애 발생 시 자동 Failover → Reader를 Writer로 승격. 거의 실시간. 데이터 손실 위험 거의 없음
- **보안**: VPC, KMS 암호화, TLS, IAM 인증 지원.
- **서버리스 옵션**: Aurora Serverless → 워크로드에 따라 자동으로 인스턴스 크기/수량 조정.
##### 클러스터 구조
- **Writer Node (Primary)**
    - 유일한 쓰기 가능 인스턴스.
    - 읽기도 가능하지만, 쓰기 부하 집중.
- **Reader Node (Replica)**
    - 읽기 전용. 최대 15개까지 추가 가능.
    - Auto Scaling으로 트래픽에 따라 증감 가능.
    - **완전 동기적 복제**
- **공유 스토리지**
    - Writer/Reader가 동일한 분산 스토리지 계층을 사용.
    - 복제 지연을 최소화
    - 4개 이상 성공 시 커밋 -> 지연 최소

---
